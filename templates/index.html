<!DOCTYPE html>
<html>
<head>
    <title>Reddit Conservative Tracker</title>
</head>
<body>
    <h1>r/Conservative – Top Posts (Today)</h1>

    <h3>Charts:</h3>
    <img src="/static/post_count_chart.png" alt="Top Topics by Post Count" width="600">
    <br>
    <img src="/static/upvotes_chart.png" alt="Top Topics by Upvotes" width="600">

    <h3>Filter by Topic:</h3>
    <form method="get" action="/">
        <select name="tag" onchange="this.form.submit()">
            <option value="">All Topics</option>
            {% for tag in tags %}
                <option value="{{ tag }}" {% if tag == selected_tag %}selected{% endif %}>{{ tag }}</option>
            {% endfor %}
        </select>
    </form>

    <hr>

    {% for post in posts %}
        <h3>{{ post.title }}</h3>
        <p><strong>Topics:</strong> {{ post.topics | join(', ') }}</p>
        <p><strong>Upvotes:</strong> {{ post.upvotes }} |
           <strong>Comments:</strong> {{ post.comments }} |
           <strong>Posted:</strong> {{ post.created }}</p>
        <p><strong>Author:</strong> {{ post.author }} |
           <strong>Flair:</strong> {{ post.flair }}</p>

        {% if post.text %}
            <p><strong>Text:</strong> {{ post.text }}</p>
        {% endif %}

        <p><a href="{{ post.url }}" target="_blank">Link to Post</a></p>

        {% if post.top_comments %}
            <h4>Top Comments:</h4>
            <ul>
                {% for comment in post.top_comments %}
                    <li><strong>Upvotes:</strong> {{ comment.upvotes }} — {{ comment.body }}</li>
                {% endfor %}
            </ul>
        {% endif %}

        <hr>
    {% endfor %}
</body>
</html>

